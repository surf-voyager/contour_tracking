function [ Probe_point,mDx,mDy,mDx_max,mDy_max] = multi_Sonar_dafudao( x,y,h)
global D2R R2D
D2R=pi/180;
R2D=180/pi;
%%%%%%%%%%%%%%%%%%变量初始化%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Probe_point=0; %探测到轮廓点的数量
distance=0; %当前单波束探测到的距离
max__probe_distance = 60;
mDx=[];mDy=[]; %存储探测到的轮廓点坐标
mDx_max=[];mDy_max=[];
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
for a=-45:1:45  %模拟多波束声呐的开角
    alpha=a*D2R;
    flag=0; %0未探测到轮廓，1探测到轮廓
    for k=0:0.5:max__probe_distance   %声呐探测距离，射线形式
        
%%%  求探测点坐标
        if k > 1
            d1 = 20000;
            d2 = 20000;
            d3 = 20000;
            d4 = 20000;
            d5 = 20000;
            d6 = 20000; 
            d7 = 20000;
            d8 = 20000;   
            d9 = 20000;
            d10 = 20000; 
            [xx1,yy1]=Probepoint(k-1,alpha,h,x,y); %解算探测点坐标
            [xx2,yy2]=Probepoint(k,alpha,h,x,y);   
%%%解算探测点纵坐标，当轮廓函数改变时，随之改变
      if xx1>=7&&xx1<15
        d1=((360-385)/(7-15))*(xx1- (15) )+ (385) ;
        d2=((360-385)/(7-15))*(xx2- (15) )+ (385) ;
      elseif xx1>=15&&xx1<48
        d1=((415-385)/(48-15))*(xx1- (15) )+ (385) ;
        d2=((415-385)/(48-15))*(xx2- (15) )+ (385) ;
      elseif xx1>=48&&xx1<80
        d1=((415-425)/(48-80))*(xx1- (48) )+ (415);
        d2=((415-425)/(48-80))*(xx2- (48) )+ (415);
      elseif xx1>=80&&xx1<148
        d1=((430-425)/(148-80))*(xx1- (148) )+ (430);
        d2=((430-425)/(148-80))*(xx2- (148) )+ (430);
      elseif xx1>=148&&xx1<190
        d1=((430-430)/(148-198))*(xx1- (148) )+ (430);
        d2=((430-430)/(148-198))*(xx2- (148) )+ (430);
      elseif xx1>=190&&xx1<264
        d1=((430-462)/(190-264))*(xx1- (190) )+ (430);
        d2=((430-462)/(190-264))*(xx2- (190) )+ (430);      
      elseif xx1>=264&&xx1<370
        d1=((476-462)/(370-264))*(xx1- (264) )+ (462);
        d2=((476-462)/(370-264))*(xx2- (264) )+ (462); 
      elseif xx1>=370&&xx1<408
        d1=((476-505)/(370-408))*(xx1- (370) )+ (476);
        d2=((476-505)/(370-408))*(xx2- (370) )+ (476); 
      elseif xx1>=408&&xx1<428
        d1=((670-505)/(428-408))*(xx1- (408) )+ (505);
        d2=((670-505)/(428-408))*(xx2- (408) )+ (505);
%
%       
%%%        
      elseif xx1>=428&&xx1<450
        d1=((835-882)/(428-450))*(xx1- (450) )+ (882);
        d2=((835-882)/(428-450))*(xx2- (450) )+ (882);         
      elseif xx1>=450&&xx1<505
        d1=((944-882)/(505-450))*(xx1- (450) )+ (882);
        d2=((944-882)/(505-450))*(xx2- (450) )+ (882);         
      elseif xx1>=505&&xx1<566
        d1=((944-980)/(505-566))*(xx1- (566) )+ (980);
        d2=((944-980)/(505-566))*(xx2- (566) )+ (980);        
      elseif xx1>=566&&xx1<635
        d1=((992-980)/(635-566))*(xx1- (566) )+ (980);
        d2=((992-980)/(635-566))*(xx2- (566) )+ (980);
      elseif xx1>=635&&xx1<700
        d1=((992-980)/(635-700))*(xx1- (700) )+ (980);
        d2=((992-980)/(635-700))*(xx2- (700) )+ (980);          
      elseif xx1>=700&&xx1<778
        d1=((946-980)/(778-700))*(xx1- (700) )+ (980);
        d2=((946-980)/(778-700))*(xx2- (700) )+ (980);         
      elseif xx1>=778&&xx1<810
        d1=((946-925)/(778-810))*(xx1- (810) )+ (925);
        d2=((946-925)/(778-810))*(xx2- (810) )+ (925);  
      elseif xx1>=810&&xx1<835
        d1=((885-925)/(835-810))*(xx1- (810) )+ (925);
        d2=((885-925)/(835-810))*(xx2- (810) )+ (925);    
      elseif xx1>=835&&xx1<845
        d1=((885-840)/(835-845))*(xx1- (845) )+ (840);
        d2=((885-840)/(835-845))*(xx2- (845) )+ (840);          
%
%
%
%
%
%
%
      elseif xx1>=845&&xx1<885
        d1=((432-415)/(845-885))*(xx1- (885) )+ (415);
        d2=((432-415)/(845-885))*(xx2- (885) )+ (415);    
      elseif xx1>=885&&xx1<945
        d1=((415-415)/(945-885))*(xx1- (885) )+ (415);
        d2=((415-415)/(945-885))*(xx2- (885) )+ (415);    
      elseif xx1>=945&&xx1<992
        d1=((415-425)/(945-992))*(xx1- (992) )+ (425);
        d2=((415-425)/(945-992))*(xx2- (992) )+ (425);     
      elseif xx1>=992&&xx1<1048
        d1=((418-425)/(1048-992))*(xx1- (992) )+ (425);
        d2=((418-425)/(1048-992))*(xx2- (992) )+ (425);       
      elseif xx1>=1048&&xx1<1135
        d1=((418-352)/(1048-1135))*(xx1- (1135) )+ (352);
        d2=((418-352)/(1048-1135))*(xx2- (1135) )+ (352);      
      elseif xx1>=1135&&xx1<1168
        d1=((195-352)/(1168-1135))*(xx1- (1135) )+ (352);
        d2=((195-352)/(1168-1135))*(xx2- (1135) )+ (352);  
%       
        
      end%%%解算探测点纵坐标结束

%%%探测点纵坐标与边界纵坐标相比较
        if((yy1>=d1)&&(yy2<=d2))    
            distance=k;
            flag=1;
            break;
        end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  

    if xx1>=375&&xx1<382
        d5=((698-712)/(375-382))*(xx1- (382) )+ (712);
        d6=((698-712)/(375-382))*(xx2- (382) )+ (712);  
      elseif xx1>=382&&xx1<406
        d5=((708-713)/(406-382))*(xx1- (382) )+ (713);
        d6=((708-713)/(406-382))*(xx2- (382) )+ (713);  
%%%    
      elseif xx1>=676&&xx1<680
        d5=((606-562)/(676-680))*(xx1- (680) )+ (562);
        d6=((606-562)/(676-680))*(xx2- (680) )+ (562);
      elseif xx1>=680&&xx1<720
        d5=((530-562)/(720-680))*(xx1- (680) )+ (562);
        d6=((530-562)/(720-680))*(xx2- (680) )+ (562);        
      elseif xx1>=720&&xx1<760
        d5=((530-512)/(720-760))*(xx1- (760) )+ (512);
        d6=((530-512)/(720-760))*(xx2- (760) )+ (512);       
      elseif xx1>=760&&xx1<805
        d5=((512-512)/(805-760))*(xx1- (760) )+ (512);
        d6=((512-512)/(805-760))*(xx2- (760) )+ (512);      
      elseif xx1>=805&&xx1<825
        d5=((512-506)/(805-825))*(xx1- (825) )+ (506) ;
        d6=((512-506)/(805-825))*(xx2- (825) )+ (506) ;       
      elseif xx1>=825&&xx1<836
        d5=((484-506)/(836-825))*(xx1- (825) )+ (506);
        d6=((484-506)/(836-825))*(xx2- (825) )+ (506);      
      elseif xx1>=832&&xx1<845
        d5=((432-458)/(845-832))*(xx1- (832) )+ (458);
        d6=((432-458)/(845-832))*(xx2- (832) )+ (458);
      elseif xx1>=642&&xx1<650
        d5=((130-55)/(650-642))*(xx1- (642) )+ (55);
        d6=((130-55)/(650-642))*(xx2- (642) )+ (55);     
    end
    
    
        if((yy1>=d5)&&(yy2<=d6))    
            distance=k;
            flag=1;
            break;
        end    
        
        
    if xx1>=406&&xx1<428
        d9=((835-708)/(428-406))*(xx1- (406) )+ (708);
        d10=((835-708)/(428-406))*(xx2- (406) )+ (708);   
    end
    
        if((yy1>=d9)&&(yy2<=d10))    
            distance=k;
            flag=1;
            break;
        end   
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
   
      if xx1>=408&&xx1<428
        d3=((670-690)/(428-408))*(xx1- (408) )+ (690);
        d4=((670-690)/(428-408))*(xx2- (408) )+ (690);
      elseif xx1>=375&&xx1<408
        d3= ((698-690)/(375-408))*(xx1- (408) )+ (690);
        d4= ((698-690)/(375-408))*(xx2- (408) )+ (690); 
%
      elseif xx1>=832&&xx1<845
        d3= ((800-840)/(832-845))*(xx1- (845) )+ (840);
        d4= ((800-840)/(832-845))*(xx2- (845) )+ (840);          
      elseif xx1>=698&&xx1<832
        d3= ((800-666)/(832-698))*(xx1- (698) )+ (666);
        d4= ((800-666)/(832-698))*(xx2- (698) )+ (666);         
      elseif xx1>=676&&xx1<698
        d3= ((606-666)/(676-698))*(xx1- (698) )+ (666);
        d4= ((606-666)/(676-698))*(xx2- (698) )+ (666);        
%      
      elseif xx1>=1110&&xx1<1168
        d3= ((195-132.5)/(1168-1110))*(xx1- (1110) )+ (132.5);
        d4= ((195-132.5)/(1168-1110))*(xx2- (1110) )+ (132.5);         
      elseif xx1>=1023&&xx1<1110
        d3= ((92-132.5)/(1023-1110))*(xx1- (1110) )+ (132.5);
        d4= ((92-132.5)/(1023-1110))*(xx2- (1110) )+ (132.5);       
      elseif xx1>=898&&xx1<1023
        d3= ((92-92)/(1023-898))*(xx1- (898) )+ (92);
        d4= ((92-92)/(1023-898))*(xx2- (898) )+ (92);        
%
%
%
      elseif xx1>=642&&xx1<665
        d3= ((18-55)/(665-642))*(xx1- (642) )+ (55);
        d4= ((18-55)/(665-642))*(xx2- (642) )+ (55);         
%     
      elseif xx1>=585&&xx1<628
        d3= ((198-170)/(585-628))*(xx1- (628) )+ (170);
        d4= ((198-170)/(585-628))*(xx2- (628) )+ (170);        
      elseif xx1>=470&&xx1<585
        d3= ((198-202)/(585-470))*(xx1- (470) )+ (202);
        d4= ((198-202)/(585-470))*(xx2- (470) )+ (202);         
%    
      elseif xx1>=290&&xx1<365
        d3= ((220-210)/(365-290))*(xx1- (290) )+ (210);
        d4= ((220-210)/(365-290))*(xx2- (290) )+ (210);         
      elseif xx1>=120&&xx1<290
        d3= ((254-210)/(120-290))*(xx1- (290) )+ (210);
        d4= ((254-210)/(120-290))*(xx2- (290) )+ (210);         
      elseif xx1>=90&&xx1<120
        d3= ((254-278)/(120-90))*(xx1- (90) )+ (278);
        d4= ((254-278)/(120-90))*(xx2- (90) )+ (278);         
      elseif xx1>=32&&xx1<90
        d3= ((298-278)/(32-90))*(xx1- (90) )+ (278);
        d4= ((298-278)/(32-90))*(xx2- (90) )+ (278);          
      elseif xx1>=15&&xx1<32
        d3= ((298-322)/(32-15))*(xx1- (15) )+ (322);
        d4= ((298-322)/(32-15))*(xx2- (15) )+ (322);        
      elseif xx1>=7&&xx1<15
        d3= ((360-322)/(7-15))*(xx1- (15) )+ (322);
        d4= ((360-322)/(7-15))*(xx2- (15) )+ (322);        
        
      end 
        
        
        if((yy1<=d3)&&(yy2>=d4))    
            distance=k;
            flag=1;
            break;
        end
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%       
 
%       if xx1>=410&&xx1<416
%         d7= ((707-730)/(416-410))*(xx1- (410) )+ (730);
%         d8= ((707-730)/(416-410))*(xx2- (410) )+ (730);
      if xx1>=832&&xx1<836
        d7= ((484-458)/(836-832))*(xx1- (832) )+ (458);
        d8= ((484-458)/(836-832))*(xx2- (832) )+ (458);
      elseif xx1>=758&&xx1<898
        d7= ((8-92)/(758-898))*(xx1- (898) )+ (92);
        d8= ((8-92)/(758-898))*(xx2- (898) )+ (92);          
      elseif xx1>=720&&xx1<758
        d7= ((8-6)/(758-720))*(xx1- (720) )+ (6);
        d8= ((8-6)/(758-720))*(xx2- (720) )+ (6);        
      elseif xx1>=665&&xx1<720
        d7= ((18-6)/(665-720))*(xx1- (720) )+ (6);
        d8= ((18-6)/(665-720))*(xx2- (720) )+ (6);  
      elseif xx1>=628&&xx1<650
        d7= ((130-170)/(650-628))*(xx1- (628) )+ (170);
        d8= ((130-170)/(650-628))*(xx2- (628) )+ (170);
      elseif xx1>=365&&xx1<470
        d7= ((220-202)/(365-470))*(xx1- (470) )+ (202);
        d8= ((220-202)/(365-470))*(xx2- (470) )+ (202);   
        
      end 
        
        if((yy1<=d7)&&(yy2>=d8))    
            distance=k;
            flag=1;
            break;
        end
                
        end
%%%k++,进入下一次循环        
    end

    if flag==0
        distance=max__probe_distance;%当声纳探测不到障碍物时，默认为声纳的最大探测距离；
    	mDx_max=[mDx_max;xx2];mDy_max=[mDy_max;yy2];
    end
    
    if distance<max__probe_distance
        Probe_point=Probe_point+1; %计算探测点数量
        mDx=[mDx;xx2];mDy=[mDy;yy2]; %只保存声呐探测点的坐标
    end
    %%%声呐开角度数++,进入下一次循环
%     if 45==a
%         hold off
%     end
    
end
    
    